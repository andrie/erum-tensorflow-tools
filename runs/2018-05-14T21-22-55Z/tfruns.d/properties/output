
> library(keras)

> # Load the test data
> x_walk <- readRDS("data/x_walk.rds")

> y_walk <- readRDS("data/y_walk.rds")

> # Make an empty model
> model <- keras_model_sequential() %>%
+   layer_conv_1d(
+     filters = 32, 
+     kernel_size = 30,
+     activation = "re ..." ... [TRUNCATED] 

> model
Model
______________________________________________________________________________________________
Layer (type)                              Output Shape                         Param #        
==============================================================================================
conv1d_1 (Conv1D)                         (None, 231, 32)                      2912           
______________________________________________________________________________________________
max_pooling1d_1 (MaxPooling1D)            (None, 115, 32)                      0              
______________________________________________________________________________________________
conv1d_2 (Conv1D)                         (None, 106, 64)                      20544          
______________________________________________________________________________________________
max_pooling1d_2 (MaxPooling1D)            (None, 53, 64)                       0              
______________________________________________________________________________________________
dropout_1 (Dropout)                       (None, 53, 64)                       0              
______________________________________________________________________________________________
flatten_1 (Flatten)                       (None, 3392)                         0              
______________________________________________________________________________________________
dense_1 (Dense)                           (None, 100)                          339300         
______________________________________________________________________________________________
dropout_2 (Dropout)                       (None, 100)                          0              
______________________________________________________________________________________________
dense_2 (Dense)                           (None, 15)                           1515           
==============================================================================================
Total params: 364,271
Trainable params: 364,271
Non-trainable params: 0
______________________________________________________________________________________________



> # Compile
> model %>%
+   compile(
+     loss = "categorical_crossentropy",
+     optimizer = "adam",
+     metrics = c("accuracy")
+   )

> # Run
> history <- model %>% 
+   fit(
+     x_walk$train,
+     y_walk$train,
+     epochs = 15,
+     batch_size = 64,
+     validation_split = 0. .... [TRUNCATED] 

> # Evaluate
> model %>%
+   evaluate(x_walk$test, y_walk$test, verbose = 0)
$loss
[1] 0.1655662

$acc
[1] 0.9514349

